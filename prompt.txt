redis    | 2026-02-03 14:43:49.375 | 1:C 03 Feb 2026 10:43:49.375 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
redis    | 2026-02-03 14:43:49.375 | 1:C 03 Feb 2026 10:43:49.375 * Redis version=7.4.7, bits=64, commit=00000000, modified=0, pid=1, just started
redis    | 2026-02-03 14:43:49.375 | 1:C 03 Feb 2026 10:43:49.375 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf
redis    | 2026-02-03 14:43:49.376 | 1:M 03 Feb 2026 10:43:49.376 * monotonic clock: POSIX clock_gettime
redis    | 2026-02-03 14:43:49.380 | 1:M 03 Feb 2026 10:43:49.380 * Running mode=standalone, port=6379.
redis    | 2026-02-03 14:43:49.382 | 1:M 03 Feb 2026 10:43:49.382 * Server initialized
redis    | 2026-02-03 14:43:49.382 | 1:M 03 Feb 2026 10:43:49.382 * Ready to accept connections tcp
postgres | 2026-02-03 14:43:49.481 | The files belonging to this database system will be owned by user "postgres".
postgres | 2026-02-03 14:43:49.481 | This user must also own the server process.
postgres | 2026-02-03 14:43:49.481 | 
postgres | 2026-02-03 14:43:49.481 | The database cluster will be initialized with locale "en_US.utf8".
postgres | 2026-02-03 14:43:49.481 | The default database encoding has accordingly been set to "UTF8".
postgres | 2026-02-03 14:43:49.481 | The default text search configuration will be set to "english".
postgres | 2026-02-03 14:43:49.481 | 
postgres | 2026-02-03 14:43:49.481 | Data page checksums are disabled.
postgres | 2026-02-03 14:43:49.481 | 
postgres | 2026-02-03 14:43:49.481 | fixing permissions on existing directory /var/lib/postgresql/data ... ok
postgres | 2026-02-03 14:43:49.494 | creating subdirectories ... ok
postgres | 2026-02-03 14:43:49.494 | selecting dynamic shared memory implementation ... posix
postgres | 2026-02-03 14:43:49.529 | selecting default max_connections ... 100
postgres | 2026-02-03 14:43:49.578 | selecting default shared_buffers ... 128MB
postgres | 2026-02-03 14:43:49.652 | selecting default time zone ... UTC
postgres | 2026-02-03 14:43:49.654 | creating configuration files ... ok
postgres | 2026-02-03 14:43:49.888 | running bootstrap script ... ok
postgres | 2026-02-03 14:43:50.230 | sh: locale: not found
postgres | 2026-02-03 14:43:50.230 | 2026-02-03 10:43:50.230 UTC [35] WARNING:  no usable system locales were found
postgres | 2026-02-03 14:43:50.983 | performing post-bootstrap initialization ... ok
postgres | 2026-02-03 14:43:52.013 | syncing data to disk ... ok
postgres | 2026-02-03 14:43:52.013 | 
postgres | 2026-02-03 14:43:52.013 | 
postgres | 2026-02-03 14:43:52.013 | Success. You can now start the database server using:
postgres | 2026-02-03 14:43:52.013 | 
postgres | 2026-02-03 14:43:52.013 |     pg_ctl -D /var/lib/postgresql/data -l logfile start
postgres | 2026-02-03 14:43:52.013 | 
postgres | 2026-02-03 14:43:52.013 | initdb: warning: enabling "trust" authentication for local connections
postgres | 2026-02-03 14:43:52.013 | initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
postgres | 2026-02-03 14:43:52.108 | waiting for server to start....2026-02-03 10:43:52.107 UTC [41] LOG:  starting PostgreSQL 16.11 on x86_64-pc-linux-musl, compiled by gcc (Alpine 15.2.0) 15.2.0, 64-bit
postgres | 2026-02-03 14:43:52.113 | 2026-02-03 10:43:52.113 UTC [41] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres | 2026-02-03 14:43:52.129 | 2026-02-03 10:43:52.129 UTC [44] LOG:  database system was shut down at 2026-02-03 10:43:50 UTC
postgres | 2026-02-03 14:43:52.144 | 2026-02-03 10:43:52.144 UTC [41] LOG:  database system is ready to accept connections
postgres | 2026-02-03 14:43:52.155 |  done
postgres | 2026-02-03 14:43:52.155 | server started
postgres | 2026-02-03 14:43:52.294 | CREATE DATABASE
postgres | 2026-02-03 14:43:52.295 | 
postgres | 2026-02-03 14:43:52.296 | 
postgres | 2026-02-03 14:43:52.296 | /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*
postgres | 2026-02-03 14:43:52.296 | 
postgres | 2026-02-03 14:43:52.297 | waiting for server to shut down...2026-02-03 10:43:52.297 UTC [41] LOG:  received fast shutdown request
postgres | 2026-02-03 14:43:52.302 | .2026-02-03 10:43:52.301 UTC [41] LOG:  aborting any active transactions
postgres | 2026-02-03 14:43:52.306 | 2026-02-03 10:43:52.306 UTC [41] LOG:  background worker "logical replication launcher" (PID 47) exited with exit code 1
postgres | 2026-02-03 14:43:52.307 | 2026-02-03 10:43:52.307 UTC [42] LOG:  shutting down
postgres | 2026-02-03 14:43:52.312 | 2026-02-03 10:43:52.312 UTC [42] LOG:  checkpoint starting: shutdown immediate
postgres | 2026-02-03 14:43:52.656 | 2026-02-03 10:43:52.656 UTC [42] LOG:  checkpoint complete: wrote 926 buffers (5.7%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.041 s, sync=0.283 s, total=0.349 s; sync files=301, longest=0.005 s, average=0.001 s; distance=4272 kB, estimate=4272 kB; lsn=0/191E918, redo lsn=0/191E918
postgres | 2026-02-03 14:43:52.679 | 2026-02-03 10:43:52.678 UTC [41] LOG:  database system is shut down
postgres | 2026-02-03 14:43:52.698 |  done
postgres | 2026-02-03 14:43:52.699 | server stopped
postgres | 2026-02-03 14:43:52.701 | 
postgres | 2026-02-03 14:43:52.701 | PostgreSQL init process complete; ready for start up.
postgres | 2026-02-03 14:43:52.701 | 
postgres | 2026-02-03 14:43:52.748 | 2026-02-03 10:43:52.748 UTC [1] LOG:  starting PostgreSQL 16.11 on x86_64-pc-linux-musl, compiled by gcc (Alpine 15.2.0) 15.2.0, 64-bit
postgres | 2026-02-03 14:43:52.748 | 2026-02-03 10:43:52.748 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
postgres | 2026-02-03 14:43:52.748 | 2026-02-03 10:43:52.748 UTC [1] LOG:  listening on IPv6 address "::", port 5432
postgres | 2026-02-03 14:43:52.759 | 2026-02-03 10:43:52.759 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres | 2026-02-03 14:43:52.772 | 2026-02-03 10:43:52.771 UTC [57] LOG:  database system was shut down at 2026-02-03 10:43:52 UTC
postgres | 2026-02-03 14:43:52.785 | 2026-02-03 10:43:52.785 UTC [1] LOG:  database system is ready to accept connections
bot      | 2026-02-03 14:43:53.135 | 2026-02-03 10:43:53,135 | INFO | root | üöÄ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
bot      | 2026-02-03 14:43:53.476 | 2026-02-03 10:43:53,476 | INFO | root | üëÇ –ù–∞—á–∏–Ω–∞—é polling...
bot      | 2026-02-03 14:43:53.477 | 2026-02-03 10:43:53,476 | INFO | aiogram.dispatcher | Start polling
bot      | 2026-02-03 14:43:53.820 | 2026-02-03 10:43:53,819 | INFO | aiogram.dispatcher | Run polling for bot @NapominanieD_bot id=8171913789 - '–¢–µ—Å—Ç'
bot      | 2026-02-03 14:44:18.811 | 2026-02-03 10:44:18,799 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:44:18.811 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:44:18.811 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:44:18.811 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:44:18.811 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:44:18.811 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:44:18.811 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:44:18.811 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:44:18.811 |     return await executor(protocol)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:44:18.811 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:44:18.811 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:44:18.811 |     self.dialect.do_execute(
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:44:18.811 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:44:18.811 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:44:18.811 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:44:18.811 |     value = await result
bot      | 2026-02-03 14:44:18.811 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:44:18.811 |     self._handle_exception(error)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:44:18.811 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:44:18.811 |     raise translated_error from error
bot      | 2026-02-03 14:44:18.811 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:18.811 | 
bot      | 2026-02-03 14:44:18.811 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:44:18.811 |     return await handler(event, data)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:44:18.811 |     return await handler(event, data)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:44:18.811 |     return await handler(event, data)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:44:18.811 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:44:18.811 |     return await wrapped()
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:44:18.811 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:44:18.811 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:44:18.811 |     return await self._propagate_event(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:44:18.811 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:44:18.811 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:44:18.811 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:44:18.811 |     return await self._propagate_event(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:44:18.811 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:44:18.811 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:44:18.811 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:44:18.811 |     return await wrapped()
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/app/app/handlers/user_catalog.py", line 37, in start
bot      | 2026-02-03 14:44:18.811 |     user = await upsert_user(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/app/app/db.py", line 69, in upsert_user
bot      | 2026-02-03 14:44:18.811 |     res = await session.execute(select(User).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:44:18.811 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:44:18.811 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:44:18.811 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:44:18.811 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:44:18.811 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:44:18.811 |     return self._execute_internal(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:44:18.811 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:44:18.811 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:44:18.811 |     result = conn.execute(
bot      | 2026-02-03 14:44:18.811 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:44:18.811 |     return meth(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:44:18.811 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:44:18.811 |     ret = self._execute_context(
bot      | 2026-02-03 14:44:18.811 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:44:18.811 |     return self._exec_single_context(
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:44:18.811 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:44:18.811 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:44:18.811 |     self.dialect.do_execute(
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:44:18.811 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:44:18.811 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:44:18.811 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:44:18.811 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:44:18.811 |     value = await result
bot      | 2026-02-03 14:44:18.811 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:44:18.811 |     self._handle_exception(error)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:44:18.811 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:44:18.811 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:44:18.811 |     raise translated_error from error
bot      | 2026-02-03 14:44:18.811 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:18.811 | [SQL: SELECT users.id, users.tg_id, users.username, users.first_name, users.phone, users.role, users.created_at 
bot      | 2026-02-03 14:44:18.811 | FROM users 
bot      | 2026-02-03 14:44:18.811 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:44:18.811 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:44:18.811 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:44:18.811 | 2026-02-03 10:44:18,810 | INFO | aiogram.event | Update id=609765512 is handled. Duration 37 ms by bot id=8171913789
bot      | 2026-02-03 14:44:36.828 | 2026-02-03 10:44:36,825 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:44:36.828 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:36.828 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:44:36.828 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:44:36.828 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:44:36.829 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:44:36.829 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:44:36.829 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:44:36.829 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:44:36.829 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:44:36.829 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:44:36.829 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:44:36.829 |     return await executor(protocol)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:44:36.829 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:44:36.829 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:44:36.829 |     self.dialect.do_execute(
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:44:36.829 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:44:36.829 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:44:36.829 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:44:36.829 |     value = await result
bot      | 2026-02-03 14:44:36.829 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:44:36.829 |     self._handle_exception(error)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:44:36.829 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:44:36.829 |     raise translated_error from error
bot      | 2026-02-03 14:44:36.829 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:44:36.829 | 
bot      | 2026-02-03 14:44:36.829 | Traceback (most recent call last):
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:44:36.829 |     return await handler(event, data)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:44:36.829 |     return await handler(event, data)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:44:36.829 |     return await handler(event, data)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:44:36.829 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:44:36.829 |     return await wrapped()
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:44:36.829 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:44:36.829 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:44:36.829 |     return await self._propagate_event(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:44:36.829 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:44:36.829 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:44:36.829 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:44:36.829 |     return await self._propagate_event(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:44:36.829 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:44:36.829 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:44:36.829 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:44:36.829 |     return await wrapped()
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/app/app/handlers/user_catalog.py", line 37, in start
bot      | 2026-02-03 14:44:36.829 |     user = await upsert_user(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/app/app/db.py", line 69, in upsert_user
bot      | 2026-02-03 14:44:36.829 |     res = await session.execute(select(User).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:44:36.829 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:44:36.829 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:44:36.829 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:44:36.829 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:44:36.829 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:44:36.829 |     return self._execute_internal(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:44:36.829 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:44:36.829 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:44:36.829 |     result = conn.execute(
bot      | 2026-02-03 14:44:36.829 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:44:36.829 |     return meth(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:44:36.829 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:44:36.829 |     ret = self._execute_context(
bot      | 2026-02-03 14:44:36.829 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:44:36.829 |     return self._exec_single_context(
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:44:36.829 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:44:36.829 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:44:36.829 |     self.dialect.do_execute(
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:44:36.829 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:44:36.829 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:44:36.829 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:44:36.829 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:44:36.829 |     value = await result
bot      | 2026-02-03 14:44:36.829 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:44:36.829 |     self._handle_exception(error)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:44:36.829 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:44:36.829 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:44:36.829 |     raise translated_error from error
bot      | 2026-02-03 14:44:36.829 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:44:36.829 | [SQL: SELECT users.id, users.tg_id, users.username, users.first_name, users.phone, users.role, users.created_at 
bot      | 2026-02-03 14:44:36.829 | FROM users 
bot      | 2026-02-03 14:44:36.829 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:44:36.829 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:44:36.829 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:44:36.829 | 2026-02-03 10:44:36,828 | INFO | aiogram.event | Update id=609765513 is handled. Duration 8 ms by bot id=8171913789
postgres | 2026-02-03 14:44:51.510 | 2026-02-03 10:44:51.509 UTC [1] LOG:  received fast shutdown request
bot      | 2026-02-03 14:44:51.511 | 2026-02-03 10:44:51,510 | WARNING | aiogram.dispatcher | Received SIGTERM signal
bot      | 2026-02-03 14:44:51.512 | 2026-02-03 10:44:51,511 | INFO | aiogram.dispatcher | Polling stopped for bot @NapominanieD_bot id=8171913789 - '–¢–µ—Å—Ç'
bot      | 2026-02-03 14:44:51.512 | 2026-02-03 10:44:51,512 | INFO | aiogram.dispatcher | Polling stopped
postgres | 2026-02-03 14:44:51.519 | 2026-02-03 10:44:51.519 UTC [1] LOG:  aborting any active transactions
redis    | 2026-02-03 14:44:51.520 | 1:signal-handler (1770115491) Received SIGTERM scheduling shutdown...
postgres | 2026-02-03 14:44:51.522 | 2026-02-03 10:44:51.521 UTC [61] FATAL:  terminating connection due to administrator command
postgres | 2026-02-03 14:44:51.525 | 2026-02-03 10:44:51.524 UTC [1] LOG:  background worker "logical replication launcher" (PID 60) exited with exit code 1
postgres | 2026-02-03 14:44:51.529 | 2026-02-03 10:44:51.528 UTC [55] LOG:  shutting down
postgres | 2026-02-03 14:44:51.535 | 2026-02-03 10:44:51.534 UTC [55] LOG:  checkpoint starting: shutdown immediate
redis    | 2026-02-03 14:44:51.571 | 1:M 03 Feb 2026 10:44:51.571 * User requested shutdown...
redis    | 2026-02-03 14:44:51.571 | 1:M 03 Feb 2026 10:44:51.571 * Saving the final RDB snapshot before exiting.
redis    | 2026-02-03 14:44:51.594 | 1:M 03 Feb 2026 10:44:51.594 * DB saved on disk
redis    | 2026-02-03 14:44:51.594 | 1:M 03 Feb 2026 10:44:51.594 # Redis is now ready to exit, bye bye...
postgres | 2026-02-03 14:44:51.690 | 2026-02-03 10:44:51.689 UTC [55] LOG:  checkpoint complete: wrote 133 buffers (0.8%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.014 s, sync=0.116 s, total=0.161 s; sync files=78, longest=0.008 s, average=0.002 s; distance=525 kB, estimate=525 kB; lsn=0/19A2100, redo lsn=0/19A2100
postgres | 2026-02-03 14:44:51.703 | 2026-02-03 10:44:51.703 UTC [1] LOG:  database system is shut down
redis    | 2026-02-03 14:44:52.370 | 1:C 03 Feb 2026 10:44:52.370 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
redis    | 2026-02-03 14:44:52.370 | 1:C 03 Feb 2026 10:44:52.370 * Redis version=7.4.7, bits=64, commit=00000000, modified=0, pid=1, just started
redis    | 2026-02-03 14:44:52.370 | 1:C 03 Feb 2026 10:44:52.370 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf
redis    | 2026-02-03 14:44:52.372 | 1:M 03 Feb 2026 10:44:52.371 * monotonic clock: POSIX clock_gettime
redis    | 2026-02-03 14:44:52.375 | 1:M 03 Feb 2026 10:44:52.374 * Running mode=standalone, port=6379.
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.375 * Server initialized
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * Loading RDB produced by version 7.4.7
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * RDB age 1 seconds
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * RDB memory usage when created 0.95 Mb
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * Done loading RDB, keys loaded: 0, keys expired: 0.
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * DB loaded from disk: 0.000 seconds
redis    | 2026-02-03 14:44:52.376 | 1:M 03 Feb 2026 10:44:52.376 * Ready to accept connections tcp
postgres | 2026-02-03 14:44:52.555 | 
postgres | 2026-02-03 14:44:52.555 | PostgreSQL Database directory appears to contain a database; Skipping initialization
postgres | 2026-02-03 14:44:52.555 | 
postgres | 2026-02-03 14:44:52.602 | 2026-02-03 10:44:52.601 UTC [1] LOG:  starting PostgreSQL 16.11 on x86_64-pc-linux-musl, compiled by gcc (Alpine 15.2.0) 15.2.0, 64-bit
postgres | 2026-02-03 14:44:52.602 | 2026-02-03 10:44:52.601 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
postgres | 2026-02-03 14:44:52.602 | 2026-02-03 10:44:52.601 UTC [1] LOG:  listening on IPv6 address "::", port 5432
postgres | 2026-02-03 14:44:52.611 | 2026-02-03 10:44:52.611 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres | 2026-02-03 14:44:52.624 | 2026-02-03 10:44:52.624 UTC [30] LOG:  database system was shut down at 2026-02-03 10:44:51 UTC
postgres | 2026-02-03 14:44:52.639 | 2026-02-03 10:44:52.638 UTC [1] LOG:  database system is ready to accept connections
bot      | 2026-02-03 14:44:56.083 | 2026-02-03 10:44:56,083 | INFO | root | üöÄ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
bot      | 2026-02-03 14:44:56.265 | 2026-02-03 10:44:56,265 | INFO | root | üëÇ –ù–∞—á–∏–Ω–∞—é polling...
bot      | 2026-02-03 14:44:56.266 | 2026-02-03 10:44:56,266 | INFO | aiogram.dispatcher | Start polling
bot      | 2026-02-03 14:44:56.597 | 2026-02-03 10:44:56,597 | INFO | aiogram.dispatcher | Run polling for bot @NapominanieD_bot id=8171913789 - '–¢–µ—Å—Ç'
bot      | 2026-02-03 14:45:31.479 | 2026-02-03 10:45:31,478 | INFO | aiogram.event | Update id=609765514 is handled. Duration 518 ms by bot id=8171913789
bot      | 2026-02-03 14:45:35.612 | 2026-02-03 10:45:35,601 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:45:35.613 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:45:35.613 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:45:35.613 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:45:35.613 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:45:35.613 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:45:35.613 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:45:35.613 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:45:35.613 |     return await executor(protocol)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:45:35.613 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:35.613 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:35.613 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:35.613 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:35.613 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:35.613 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:35.613 |     value = await result
bot      | 2026-02-03 14:45:35.613 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:35.613 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:35.613 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:35.613 |     raise translated_error from error
bot      | 2026-02-03 14:45:35.613 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:35.613 | 
bot      | 2026-02-03 14:45:35.613 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:45:35.613 |     return await handler(event, data)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:45:35.613 |     return await handler(event, data)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:45:35.613 |     return await handler(event, data)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:35.613 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:35.613 |     return await wrapped()
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:45:35.613 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:35.613 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:35.613 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:45:35.613 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:35.613 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:35.613 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:35.613 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:45:35.613 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:45:35.613 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:35.613 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:35.613 |     return await wrapped()
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/app/app/handlers/admin_panel.py", line 57, in admin_req_list
bot      | 2026-02-03 14:45:35.613 |     if not await is_admin(session, c.from_user.id):
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/app/app/db.py", line 91, in is_admin
bot      | 2026-02-03 14:45:35.613 |     role = await get_user_role(session, tg_id)
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/app/app/db.py", line 86, in get_user_role
bot      | 2026-02-03 14:45:35.613 |     res = await session.execute(select(User.role).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:45:35.613 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:45:35.613 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:45:35.613 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:45:35.613 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:45:35.613 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:45:35.613 |     return self._execute_internal(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:45:35.613 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:45:35.613 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:45:35.613 |     result = conn.execute(
bot      | 2026-02-03 14:45:35.613 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:45:35.613 |     return meth(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:45:35.613 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:45:35.613 |     ret = self._execute_context(
bot      | 2026-02-03 14:45:35.613 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:45:35.613 |     return self._exec_single_context(
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:45:35.613 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:45:35.613 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:35.613 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:35.613 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:35.613 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:35.613 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:35.613 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:35.613 |     value = await result
bot      | 2026-02-03 14:45:35.613 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:35.613 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:35.613 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:35.613 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:35.613 |     raise translated_error from error
bot      | 2026-02-03 14:45:35.613 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:35.613 | [SQL: SELECT users.role 
bot      | 2026-02-03 14:45:35.613 | FROM users 
bot      | 2026-02-03 14:45:35.613 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:45:35.613 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:45:35.613 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:45:35.613 | 2026-02-03 10:45:35,612 | INFO | aiogram.event | Update id=609765515 is handled. Duration 53 ms by bot id=8171913789
bot      | 2026-02-03 14:45:47.036 | 2026-02-03 10:45:47,031 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:45:47.036 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:45:47.036 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:45:47.036 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:45:47.036 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:45:47.036 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:45:47.036 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:45:47.036 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:45:47.036 |     return await executor(protocol)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:45:47.036 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:47.036 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:47.036 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:47.036 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:47.036 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:47.036 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:47.036 |     value = await result
bot      | 2026-02-03 14:45:47.036 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:47.036 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:47.036 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:47.036 |     raise translated_error from error
bot      | 2026-02-03 14:45:47.036 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:47.036 | 
bot      | 2026-02-03 14:45:47.036 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:45:47.036 |     return await handler(event, data)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:45:47.036 |     return await handler(event, data)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:45:47.036 |     return await handler(event, data)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:47.036 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:47.036 |     return await wrapped()
bot      | 2026-02-03 14:45:47.036 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.036 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:45:47.037 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:47.037 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:47.037 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:45:47.037 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:47.037 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:47.037 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:47.037 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:45:47.037 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:45:47.037 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:47.037 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:47.037 |     return await wrapped()
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/app/app/handlers/user_catalog.py", line 64, in back_start
bot      | 2026-02-03 14:45:47.037 |     role = await get_user_role(session, c.from_user.id)
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/app/app/db.py", line 86, in get_user_role
bot      | 2026-02-03 14:45:47.037 |     res = await session.execute(select(User.role).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:45:47.037 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:45:47.037 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:45:47.037 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:45:47.037 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:45:47.037 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:45:47.037 |     return self._execute_internal(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:45:47.037 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:45:47.037 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:45:47.037 |     result = conn.execute(
bot      | 2026-02-03 14:45:47.037 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:45:47.037 |     return meth(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:45:47.037 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:45:47.037 |     ret = self._execute_context(
bot      | 2026-02-03 14:45:47.037 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:45:47.037 |     return self._exec_single_context(
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:45:47.037 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:45:47.037 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:47.037 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:47.037 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:47.037 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:47.037 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:47.037 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:47.037 |     value = await result
bot      | 2026-02-03 14:45:47.037 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:47.037 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:47.037 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:47.037 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:47.037 |     raise translated_error from error
bot      | 2026-02-03 14:45:47.037 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:47.037 | [SQL: SELECT users.role 
bot      | 2026-02-03 14:45:47.037 | FROM users 
bot      | 2026-02-03 14:45:47.037 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:45:47.037 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:45:47.037 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:45:47.037 | 2026-02-03 10:45:47,036 | INFO | aiogram.event | Update id=609765516 is handled. Duration 10 ms by bot id=8171913789
bot      | 2026-02-03 14:45:49.097 | 2026-02-03 10:45:49,094 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:45:49.097 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:49.097 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:49.097 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:45:49.097 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:45:49.097 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:45:49.097 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:45:49.097 | 
bot      | 2026-02-03 14:45:49.097 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:49.097 | 
bot      | 2026-02-03 14:45:49.097 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:49.097 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:45:49.097 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:45:49.097 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.097 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:45:49.097 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:45:49.098 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:45:49.098 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:45:49.098 |     return await executor(protocol)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:45:49.098 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:49.098 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:49.098 | 
bot      | 2026-02-03 14:45:49.098 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:49.098 | 
bot      | 2026-02-03 14:45:49.098 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:49.098 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:49.098 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:49.098 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:49.098 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:49.098 |     value = await result
bot      | 2026-02-03 14:45:49.098 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:49.098 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:49.098 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:49.098 |     raise translated_error from error
bot      | 2026-02-03 14:45:49.098 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:49.098 | 
bot      | 2026-02-03 14:45:49.098 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:49.098 | 
bot      | 2026-02-03 14:45:49.098 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:45:49.098 |     return await handler(event, data)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:45:49.098 |     return await handler(event, data)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:45:49.098 |     return await handler(event, data)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:49.098 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:49.098 |     return await wrapped()
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:45:49.098 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:49.098 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:49.098 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:45:49.098 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:49.098 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:49.098 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:49.098 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:45:49.098 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:45:49.098 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:49.098 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:49.098 |     return await wrapped()
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/app/app/handlers/user_catalog.py", line 37, in start
bot      | 2026-02-03 14:45:49.098 |     user = await upsert_user(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/app/app/db.py", line 69, in upsert_user
bot      | 2026-02-03 14:45:49.098 |     res = await session.execute(select(User).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:45:49.098 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:45:49.098 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:45:49.098 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:45:49.098 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:45:49.098 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:45:49.098 |     return self._execute_internal(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:45:49.098 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:45:49.098 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:45:49.098 |     result = conn.execute(
bot      | 2026-02-03 14:45:49.098 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:45:49.098 |     return meth(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:45:49.098 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:45:49.098 |     ret = self._execute_context(
bot      | 2026-02-03 14:45:49.098 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:45:49.098 |     return self._exec_single_context(
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:45:49.098 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:45:49.098 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:49.098 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:49.098 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:49.098 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:49.098 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:49.098 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:49.098 |     value = await result
bot      | 2026-02-03 14:45:49.098 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:49.098 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:49.098 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:49.098 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:49.098 |     raise translated_error from error
bot      | 2026-02-03 14:45:49.098 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:49.098 | [SQL: SELECT users.id, users.tg_id, users.username, users.first_name, users.phone, users.role, users.created_at 
bot      | 2026-02-03 14:45:49.098 | FROM users 
bot      | 2026-02-03 14:45:49.098 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:45:49.098 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:45:49.098 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:45:49.098 | 2026-02-03 10:45:49,097 | INFO | aiogram.event | Update id=609765517 is handled. Duration 9 ms by bot id=8171913789
bot      | 2026-02-03 14:45:51.274 | 2026-02-03 10:45:51,269 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:45:51.274 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:45:51.274 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:45:51.274 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:45:51.274 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:45:51.274 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:45:51.274 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:45:51.274 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:45:51.274 |     return await executor(protocol)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:45:51.274 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:51.274 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:51.274 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:51.274 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:51.274 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:51.274 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:51.274 |     value = await result
bot      | 2026-02-03 14:45:51.274 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:51.274 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:51.274 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:51.274 |     raise translated_error from error
bot      | 2026-02-03 14:45:51.274 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:51.274 | 
bot      | 2026-02-03 14:45:51.274 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:45:51.274 |     return await handler(event, data)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:45:51.274 |     return await handler(event, data)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:45:51.274 |     return await handler(event, data)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:51.274 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:51.274 |     return await wrapped()
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:45:51.274 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:51.274 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:51.274 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:45:51.274 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:51.274 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:51.274 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:51.274 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:45:51.274 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:45:51.274 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:51.274 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:51.274 |     return await wrapped()
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/app/app/handlers/user_my_requests.py", line 38, in my_req_list
bot      | 2026-02-03 14:45:51.274 |     user = await upsert_user(session, c.from_user.id, c.from_user.username, c.from_user.first_name)
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/app/app/db.py", line 69, in upsert_user
bot      | 2026-02-03 14:45:51.274 |     res = await session.execute(select(User).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:45:51.274 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:45:51.274 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:45:51.274 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:45:51.274 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:45:51.274 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:45:51.274 |     return self._execute_internal(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:45:51.274 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:45:51.274 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:45:51.274 |     result = conn.execute(
bot      | 2026-02-03 14:45:51.274 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:45:51.274 |     return meth(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:45:51.274 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:45:51.274 |     ret = self._execute_context(
bot      | 2026-02-03 14:45:51.274 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:45:51.274 |     return self._exec_single_context(
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:45:51.274 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:45:51.274 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:51.274 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:51.274 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:51.274 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:51.274 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:51.274 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:51.274 |     value = await result
bot      | 2026-02-03 14:45:51.274 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:51.274 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:51.274 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:51.274 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:51.274 |     raise translated_error from error
bot      | 2026-02-03 14:45:51.274 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:51.274 | [SQL: SELECT users.id, users.tg_id, users.username, users.first_name, users.phone, users.role, users.created_at 
bot      | 2026-02-03 14:45:51.274 | FROM users 
bot      | 2026-02-03 14:45:51.274 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:45:51.274 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:45:51.274 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:45:51.274 | 2026-02-03 10:45:51,273 | INFO | aiogram.event | Update id=609765518 is handled. Duration 15 ms by bot id=8171913789
bot      | 2026-02-03 14:45:52.559 | 2026-02-03 10:45:52,555 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:45:52.559 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:45:52.559 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:45:52.559 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:45:52.559 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:45:52.559 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:45:52.559 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:45:52.559 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:45:52.559 |     return await executor(protocol)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:45:52.559 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:45:52.559 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:52.559 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:52.559 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:52.559 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:52.559 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:52.559 |     value = await result
bot      | 2026-02-03 14:45:52.559 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:52.559 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:52.559 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:52.559 |     raise translated_error from error
bot      | 2026-02-03 14:45:52.559 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:45:52.559 | 
bot      | 2026-02-03 14:45:52.559 | Traceback (most recent call last):
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:45:52.559 |     return await handler(event, data)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:45:52.559 |     return await handler(event, data)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:45:52.559 |     return await handler(event, data)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:52.559 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:52.559 |     return await wrapped()
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:45:52.559 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:52.559 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:52.559 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:45:52.559 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:45:52.559 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:45:52.559 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:45:52.559 |     return await self._propagate_event(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:45:52.559 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:45:52.559 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:45:52.559 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:45:52.559 |     return await wrapped()
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/app/app/handlers/user_catalog.py", line 64, in back_start
bot      | 2026-02-03 14:45:52.559 |     role = await get_user_role(session, c.from_user.id)
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/app/app/db.py", line 86, in get_user_role
bot      | 2026-02-03 14:45:52.559 |     res = await session.execute(select(User.role).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:45:52.559 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:45:52.559 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:45:52.559 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:45:52.559 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:45:52.559 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:45:52.559 |     return self._execute_internal(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:45:52.559 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:45:52.559 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:45:52.559 |     result = conn.execute(
bot      | 2026-02-03 14:45:52.559 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:45:52.559 |     return meth(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:45:52.559 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:45:52.559 |     ret = self._execute_context(
bot      | 2026-02-03 14:45:52.559 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:45:52.559 |     return self._exec_single_context(
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:45:52.559 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:45:52.559 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:45:52.559 |     self.dialect.do_execute(
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:45:52.559 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:45:52.559 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:45:52.559 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:45:52.559 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.559 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:45:52.559 |     value = await result
bot      | 2026-02-03 14:45:52.559 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:45:52.560 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:45:52.560 |     self._handle_exception(error)
bot      | 2026-02-03 14:45:52.560 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:45:52.560 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:45:52.560 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:45:52.560 |     raise translated_error from error
bot      | 2026-02-03 14:45:52.560 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:45:52.560 | [SQL: SELECT users.role 
bot      | 2026-02-03 14:45:52.560 | FROM users 
bot      | 2026-02-03 14:45:52.560 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:45:52.560 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:45:52.560 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:45:52.560 | 2026-02-03 10:45:52,558 | INFO | aiogram.event | Update id=609765519 is handled. Duration 7 ms by bot id=8171913789
redis    | 2026-02-03 14:46:08.458 | 1:signal-handler (1770115568) Received SIGTERM scheduling shutdown...
postgres | 2026-02-03 14:46:08.459 | 2026-02-03 10:46:08.458 UTC [1] LOG:  received fast shutdown request
postgres | 2026-02-03 14:46:08.469 | 2026-02-03 10:46:08.469 UTC [1] LOG:  aborting any active transactions
postgres | 2026-02-03 14:46:08.469 | 2026-02-03 10:46:08.469 UTC [34] FATAL:  terminating connection due to administrator command
postgres | 2026-02-03 14:46:08.474 | 2026-02-03 10:46:08.474 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
postgres | 2026-02-03 14:46:08.476 | 2026-02-03 10:46:08.476 UTC [28] LOG:  shutting down
bot      | 2026-02-03 14:46:08.476 | 2026-02-03 10:46:08,475 | WARNING | aiogram.dispatcher | Received SIGTERM signal
bot      | 2026-02-03 14:46:08.477 | 2026-02-03 10:46:08,477 | INFO | aiogram.dispatcher | Polling stopped for bot @NapominanieD_bot id=8171913789 - '–¢–µ—Å—Ç'
bot      | 2026-02-03 14:46:08.477 | 2026-02-03 10:46:08,477 | INFO | aiogram.dispatcher | Polling stopped
postgres | 2026-02-03 14:46:08.483 | 2026-02-03 10:46:08.483 UTC [28] LOG:  checkpoint starting: shutdown immediate
redis    | 2026-02-03 14:46:08.486 | 1:M 03 Feb 2026 10:46:08.485 * User requested shutdown...
redis    | 2026-02-03 14:46:08.486 | 1:M 03 Feb 2026 10:46:08.486 * Saving the final RDB snapshot before exiting.
redis    | 2026-02-03 14:46:08.506 | 1:M 03 Feb 2026 10:46:08.506 * DB saved on disk
redis    | 2026-02-03 14:46:08.506 | 1:M 03 Feb 2026 10:46:08.506 # Redis is now ready to exit, bye bye...
postgres | 2026-02-03 14:46:08.556 | 2026-02-03 10:46:08.556 UTC [28] LOG:  checkpoint complete: wrote 37 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.012 s, sync=0.019 s, total=0.081 s; sync files=10, longest=0.007 s, average=0.002 s; distance=136 kB, estimate=136 kB; lsn=0/19C43E8, redo lsn=0/19C43E8
postgres | 2026-02-03 14:46:08.570 | 2026-02-03 10:46:08.569 UTC [1] LOG:  database system is shut down
redis    | 2026-02-03 14:46:09.321 | 1:C 03 Feb 2026 10:46:09.321 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
redis    | 2026-02-03 14:46:09.321 | 1:C 03 Feb 2026 10:46:09.321 * Redis version=7.4.7, bits=64, commit=00000000, modified=0, pid=1, just started
redis    | 2026-02-03 14:46:09.321 | 1:C 03 Feb 2026 10:46:09.321 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf
redis    | 2026-02-03 14:46:09.321 | 1:M 03 Feb 2026 10:46:09.321 * monotonic clock: POSIX clock_gettime
redis    | 2026-02-03 14:46:09.323 | 1:M 03 Feb 2026 10:46:09.323 * Running mode=standalone, port=6379.
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.323 * Server initialized
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * Loading RDB produced by version 7.4.7
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * RDB age 1 seconds
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * RDB memory usage when created 0.95 Mb
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * Done loading RDB, keys loaded: 0, keys expired: 0.
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * DB loaded from disk: 0.000 seconds
redis    | 2026-02-03 14:46:09.324 | 1:M 03 Feb 2026 10:46:09.324 * Ready to accept connections tcp
postgres | 2026-02-03 14:46:09.486 | 
postgres | 2026-02-03 14:46:09.486 | PostgreSQL Database directory appears to contain a database; Skipping initialization
postgres | 2026-02-03 14:46:09.486 | 
postgres | 2026-02-03 14:46:09.538 | 2026-02-03 10:46:09.537 UTC [1] LOG:  starting PostgreSQL 16.11 on x86_64-pc-linux-musl, compiled by gcc (Alpine 15.2.0) 15.2.0, 64-bit
postgres | 2026-02-03 14:46:09.538 | 2026-02-03 10:46:09.538 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
postgres | 2026-02-03 14:46:09.538 | 2026-02-03 10:46:09.538 UTC [1] LOG:  listening on IPv6 address "::", port 5432
postgres | 2026-02-03 14:46:09.551 | 2026-02-03 10:46:09.551 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
postgres | 2026-02-03 14:46:09.566 | 2026-02-03 10:46:09.566 UTC [29] LOG:  database system was shut down at 2026-02-03 10:46:08 UTC
postgres | 2026-02-03 14:46:09.581 | 2026-02-03 10:46:09.580 UTC [1] LOG:  database system is ready to accept connections
bot      | 2026-02-03 14:46:13.231 | 2026-02-03 10:46:13,230 | INFO | root | üöÄ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
bot      | 2026-02-03 14:46:13.436 | 2026-02-03 10:46:13,435 | INFO | root | üëÇ –ù–∞—á–∏–Ω–∞—é polling...
bot      | 2026-02-03 14:46:13.436 | 2026-02-03 10:46:13,436 | INFO | aiogram.dispatcher | Start polling
bot      | 2026-02-03 14:46:13.757 | 2026-02-03 10:46:13,757 | INFO | aiogram.dispatcher | Run polling for bot @NapominanieD_bot id=8171913789 - '–¢–µ—Å—Ç'
bot      | 2026-02-03 14:46:15.945 | 2026-02-03 10:46:15,936 | ERROR | root | Unhandled error in update processing
bot      | 2026-02-03 14:46:15.945 | Traceback (most recent call last):
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/protocol/codecs/base.pyx", line 251, in asyncpg.protocol.protocol.Codec.encode
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/protocol/codecs/base.pyx", line 153, in asyncpg.protocol.protocol.Codec.encode_scalar
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/pgproto/codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
bot      | 2026-02-03 14:46:15.945 | OverflowError: value out of int32 range
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | Traceback (most recent call last):
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 550, in _prepare_and_execute
bot      | 2026-02-03 14:46:15.945 |     self._rows = deque(await prepared_stmt.fetch(*parameters))
bot      | 2026-02-03 14:46:15.945 |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 177, in fetch
bot      | 2026-02-03 14:46:15.945 |     data = await self.__bind_execute(args, 0, timeout)
bot      | 2026-02-03 14:46:15.945 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 268, in __bind_execute
bot      | 2026-02-03 14:46:15.945 |     data, status, _ = await self.__do_execute(
bot      | 2026-02-03 14:46:15.945 |                       ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/asyncpg/prepared_stmt.py", line 257, in __do_execute
bot      | 2026-02-03 14:46:15.945 |     return await executor(protocol)
bot      | 2026-02-03 14:46:15.945 |            ^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/protocol/protocol.pyx", line 184, in bind_execute
bot      | 2026-02-03 14:46:15.945 |   File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
bot      | 2026-02-03 14:46:15.945 | asyncpg.exceptions.DataError: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | Traceback (most recent call last):
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:46:15.945 |     self.dialect.do_execute(
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:46:15.945 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:46:15.945 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:46:15.945 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:46:15.945 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:46:15.945 |     value = await result
bot      | 2026-02-03 14:46:15.945 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:46:15.945 |     self._handle_exception(error)
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:46:15.945 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:46:15.945 |     raise translated_error from error
bot      | 2026-02-03 14:46:15.945 | sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | The above exception was the direct cause of the following exception:
bot      | 2026-02-03 14:46:15.945 | 
bot      | 2026-02-03 14:46:15.945 | Traceback (most recent call last):
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/error.py", line 27, in __call__
bot      | 2026-02-03 14:46:15.945 |     return await handler(event, data)
bot      | 2026-02-03 14:46:15.945 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.945 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/middlewares/user_context.py", line 58, in __call__
bot      | 2026-02-03 14:46:15.946 |     return await handler(event, data)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/fsm/middleware.py", line 43, in __call__
bot      | 2026-02-03 14:46:15.946 |     return await handler(event, data)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:46:15.946 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:46:15.946 |     return await wrapped()
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
bot      | 2026-02-03 14:46:15.946 |     return await self.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:46:15.946 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:46:15.946 |     return await self._propagate_event(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
bot      | 2026-02-03 14:46:15.946 |     response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
bot      | 2026-02-03 14:46:15.946 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
bot      | 2026-02-03 14:46:15.946 |     return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
bot      | 2026-02-03 14:46:15.946 |     return await self._propagate_event(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
bot      | 2026-02-03 14:46:15.946 |     response = await observer.trigger(event, **kwargs)
bot      | 2026-02-03 14:46:15.946 |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
bot      | 2026-02-03 14:46:15.946 |     return await wrapped_inner(event, kwargs)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
bot      | 2026-02-03 14:46:15.946 |     return await wrapped()
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/app/app/handlers/user_catalog.py", line 64, in back_start
bot      | 2026-02-03 14:46:15.946 |     role = await get_user_role(session, c.from_user.id)
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/app/app/db.py", line 86, in get_user_role
bot      | 2026-02-03 14:46:15.946 |     res = await session.execute(select(User.role).where(User.tg_id == tg_id))
bot      | 2026-02-03 14:46:15.946 |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
bot      | 2026-02-03 14:46:15.946 |     result = await greenlet_spawn(
bot      | 2026-02-03 14:46:15.946 |              ^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
bot      | 2026-02-03 14:46:15.946 |     result = context.throw(*sys.exc_info())
bot      | 2026-02-03 14:46:15.946 |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
bot      | 2026-02-03 14:46:15.946 |     return self._execute_internal(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
bot      | 2026-02-03 14:46:15.946 |     result: Result[Any] = compile_state_cls.orm_execute_statement(
bot      | 2026-02-03 14:46:15.946 |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
bot      | 2026-02-03 14:46:15.946 |     result = conn.execute(
bot      | 2026-02-03 14:46:15.946 |              ^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
bot      | 2026-02-03 14:46:15.946 |     return meth(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
bot      | 2026-02-03 14:46:15.946 |     return connection._execute_clauseelement(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
bot      | 2026-02-03 14:46:15.946 |     ret = self._execute_context(
bot      | 2026-02-03 14:46:15.946 |           ^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
bot      | 2026-02-03 14:46:15.946 |     return self._exec_single_context(
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
bot      | 2026-02-03 14:46:15.946 |     self._handle_dbapi_exception(
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
bot      | 2026-02-03 14:46:15.946 |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
bot      | 2026-02-03 14:46:15.946 |     self.dialect.do_execute(
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
bot      | 2026-02-03 14:46:15.946 |     cursor.execute(statement, parameters)
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
bot      | 2026-02-03 14:46:15.946 |     self._adapt_connection.await_(
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
bot      | 2026-02-03 14:46:15.946 |     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
bot      | 2026-02-03 14:46:15.946 |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
bot      | 2026-02-03 14:46:15.946 |     value = await result
bot      | 2026-02-03 14:46:15.946 |             ^^^^^^^^^^^^
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
bot      | 2026-02-03 14:46:15.946 |     self._handle_exception(error)
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
bot      | 2026-02-03 14:46:15.946 |     self._adapt_connection._handle_exception(error)
bot      | 2026-02-03 14:46:15.946 |   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
bot      | 2026-02-03 14:46:15.946 |     raise translated_error from error
bot      | 2026-02-03 14:46:15.946 | sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5750295688 (value out of int32 range)
bot      | 2026-02-03 14:46:15.946 | [SQL: SELECT users.role 
bot      | 2026-02-03 14:46:15.946 | FROM users 
bot      | 2026-02-03 14:46:15.946 | WHERE users.tg_id = $1::INTEGER]
bot      | 2026-02-03 14:46:15.946 | [parameters: (5750295688,)]
bot      | 2026-02-03 14:46:15.946 | (Background on this error at: https://sqlalche.me/e/20/dbapi)
bot      | 2026-02-03 14:46:15.946 | 2026-02-03 10:46:15,945 | INFO | aiogram.event | Update id=609765520 is handled. Duration 47 ms by bot id=8171913789