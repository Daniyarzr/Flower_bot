{% extends "base.html" %}
{% block content %}
{% if request.query_params.get('sent') %}
<div class="bg-green-50 border border-green-200 text-green-600 p-4 rounded-2xl mb-4 text-sm font-bold flex justify-between">
    <span>‚úÖ –†–∞—Å—Å—ã–ª–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</span>
    <span>–ü–æ–ª—É—á–∏–ª–∏: {{ request.query_params.get('sent') }} | –û—à–∏–±–∫–∏: {{ request.query_params.get('errors') }}</span>
</div>
{% endif %}
<div class="space-y-6">
    <div class="flex justify-between items-center px-2">
        <h2 class="text-xl font-bold text-gray-800 font-serif">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞</h2>
        <button onclick="toggleBotTexts()" class="md:hidden bg-pink-500 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg shadow-pink-200 active:scale-95 transition-transform">
            ‚úèÔ∏è –¢–µ–∫—Å—Ç—ã –±–æ—Ç–∞
        </button>
    </div>

    <div class="grid grid-cols-2 gap-3">
        <div class="bg-blue-500 p-4 rounded-3xl shadow-lg shadow-blue-100 text-white">
            <p class="text-xs opacity-80">–ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</p>
            <p class="text-3xl font-black">{{ stats.new }}</p>
        </div>
        <div class="bg-orange-400 p-4 rounded-3xl shadow-lg shadow-orange-100 text-white">
            <p class="text-xs opacity-80">–í —Ä–∞–±–æ—Ç–µ</p>
            <p class="text-3xl font-black">{{ stats.in_work }}</p>
        </div>
        <div class="bg-green-500 p-4 rounded-3xl shadow-lg shadow-green-100 text-white">
            <p class="text-xs opacity-80">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
            <p class="text-3xl font-black">{{ stats.done }}</p>
        </div>
        <div class="bg-gray-800 p-4 rounded-3xl shadow-lg shadow-gray-200 text-white">
            <p class="text-xs opacity-80">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</p>
            <p class="text-3xl font-black">{{ stats.total_orders }}</p>
        </div>
    </div>

    <div class="grid md:grid-cols-3 gap-6">
        <div class="md:col-span-2 space-y-4">
            <div class="grid grid-cols-2 gap-3">
                <div class="bg-white p-4 rounded-2xl border border-pink-50 flex items-center justify-between">
                    <div>
                        <p class="text-[10px] text-gray-400 uppercase font-bold">–¢–æ–≤–∞—Ä–æ–≤</p>
                        <p class="text-xl font-bold text-pink-500">{{ stats.products }}</p>
                    </div>
                    <i class="fa-solid fa-boxes-stacked text-pink-100 text-2xl"></i>
                </div>
                <div class="bg-white p-4 rounded-2xl border border-pink-50 flex items-center justify-between">
                    <div>
                        <p class="text-[10px] text-gray-400 uppercase font-bold">–Æ–∑–µ—Ä–æ–≤</p>
                        <p class="text-xl font-bold text-pink-500">{{ stats.users }}</p>
                    </div>
                    <i class="fa-solid fa-user-group text-pink-100 text-2xl"></i>
                </div>
            </div>

            <div class="bg-white p-6 rounded-[2.5rem] border border-pink-100 shadow-sm mt-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-purple-50 rounded-full flex items-center justify-center text-purple-500">
                        <i class="fa-solid fa-bullhorn"></i>
                    </div>
                    <h3 class="font-bold text-gray-800">–ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞</h3>
                </div>
                
                <form action="/broadcast" method="post" onsubmit="return confirm('–û—Ç–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –í–°–ï–ú –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º?')">
                    <textarea name="message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ä–∞—Å—Å—ã–ª–∫–∏..." required 
                        class="w-full border-pink-100 border p-4 rounded-2xl outline-none focus:ring-2 focus:ring-pink-200 transition mb-3" rows="3"></textarea>
                    
                    <button type="submit" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 rounded-2xl shadow-lg shadow-purple-100 transition-all active:scale-95 flex items-center justify-center gap-2">
                        <i class="fa-solid fa-paper-plane text-xs"></i>
                        <span>–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</span>
                    </button>
                </form>
                <p class="text-[10px] text-gray-400 mt-2 px-2">‚ö†Ô∏è –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—å —Ä–∞–∑ –∑–∞–ø—É—Å–∫–∞–ª–∏ –±–æ—Ç–∞.</p>
            </div>
            <div class="pt-2 space-y-3">
                <h3 class="font-bold text-gray-700 px-2">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                <div class="grid grid-cols-1 gap-2">
                    <a href="/orders" class="flex items-center gap-4 bg-white p-4 rounded-2xl border border-pink-100 shadow-sm transition-all hover:border-pink-300">
                        <div class="w-10 h-10 bg-pink-50 rounded-full flex items-center justify-center text-pink-500">
                            <i class="fa-solid fa-clipboard-list"></i>
                        </div>
                        <span class="font-medium text-gray-700">–û—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫</span>
                        <i class="fa-solid fa-chevron-right ml-auto text-gray-300 text-xs"></i>
                    </a>
                    <a href="/catalog" class="flex items-center gap-4 bg-white p-4 rounded-2xl border border-pink-100 shadow-sm transition-all hover:border-pink-300">
                        <div class="w-10 h-10 bg-pink-50 rounded-full flex items-center justify-center text-pink-500">
                            <i class="fa-solid fa-plus"></i>
                        </div>
                        <span class="font-medium text-gray-700">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</span>
                        <i class="fa-solid fa-chevron-right ml-auto text-gray-300 text-xs"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="hidden md:block bg-white p-6 rounded-3xl border border-pink-100 shadow-sm">
            <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-pen-to-square text-pink-500"></i> –¢–µ–∫—Å—Ç—ã –±–æ—Ç–∞
            </h3>
            <form action="/bot-texts/save" method="post" class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-1 ml-1">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (/start)</label>
                    <textarea name="start_message" rows="4" class="w-full p-3 bg-gray-50 border border-gray-100 rounded-xl text-sm focus:ring-2 focus:ring-pink-200 outline-none transition-all">{{ (bot_texts|default({})).get('start_message', '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!') }}</textarea>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase mb-1 ml-1">–¢–µ–∫—Å—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏</label>
                    <textarea name="support_message" rows="4" class="w-full p-3 bg-gray-50 border border-gray-100 rounded-xl text-sm focus:ring-2 focus:ring-pink-200 outline-none transition-all">{{ (bot_texts|default({})).get('support_message', '–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: @admin') }}</textarea>
                </div>
                <button type="submit" class="w-full bg-pink-500 text-white font-bold py-3 rounded-xl shadow-lg shadow-pink-100 hover:bg-pink-600 transition-colors active:scale-95">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </form>
        </div>
    </div>
</div>

<div class="md:hidden fixed inset-0 z-[100] drawer-overlay bg-black/40" onclick="toggleBotTexts()"></div>
<div class="md:hidden fixed bottom-0 left-0 right-0 z-[101] bg-white rounded-t-[32px] p-6 drawer-transform shadow-[0_-10px_40px_rgba(0,0,0,0.1)]">
    <div class="w-12 h-1 bg-gray-200 rounded-full mx-auto mb-6"></div>
    <h3 class="font-bold text-gray-800 text-lg mb-4">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã</h3>
    <form action="/bot-texts/save" method="post" class="space-y-4">
        <div>
            <label class="block text-xs font-bold text-gray-400 uppercase mb-1 ml-1">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</label>
            <textarea name="start_message" rows="3" class="w-full p-3 bg-gray-50 border border-gray-100 rounded-xl text-sm focus:ring-2 focus:ring-pink-200 outline-none">{{ (bot_texts|default({})).get('start_message', '') }}</textarea>
        </div>
        <div>
            <label class="block text-xs font-bold text-gray-400 uppercase mb-1 ml-1">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</label>
            <textarea name="support_message" rows="3" class="w-full p-3 bg-gray-50 border border-gray-100 rounded-xl text-sm focus:ring-2 focus:ring-pink-200 outline-none">{{ (bot_texts|default({})).get('support_message', '') }}</textarea>
        </div>
        <button type="submit" class="w-full bg-pink-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-pink-100 active:scale-95">
            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
        </button>
        <button type="button" onclick="toggleBotTexts()" class="w-full text-gray-400 text-sm font-medium py-2">
            –û—Ç–º–µ–Ω–∞
        </button>
    </form>
</div>
{% endblock %}